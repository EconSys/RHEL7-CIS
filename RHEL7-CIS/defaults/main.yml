account_disable_post_pw_expiration: true
accounts_logon_fail_delay: true
accounts_max_concurrent_login_sessions: true
accounts_maximum_age_login_defs: true
accounts_minimum_age_login_defs: true
accounts_password_pam_dcredit: true
accounts_password_pam_difok: true
accounts_password_pam_lcredit: true
accounts_password_pam_maxclassrepeat: true
accounts_password_pam_maxrepeat: true
accounts_password_pam_minclass: true
accounts_password_pam_minlen: true
accounts_password_pam_ocredit: true
accounts_password_pam_retry: true
accounts_password_pam_ucredit: true
accounts_password_pam_unix_remember: true
accounts_passwords_pam_faillock_deny: true
accounts_passwords_pam_faillock_deny_root: true
accounts_passwords_pam_faillock_interval: true
accounts_passwords_pam_faillock_unlock_time: true
accounts_tmout: true
accounts_umask_etc_login_defs: true
aide_periodic_cron_checking: true
audit_rules_dac_modification_chmod: true
audit_rules_dac_modification_chown: true
audit_rules_dac_modification_fchmod: true
audit_rules_dac_modification_fchmodat: true
audit_rules_dac_modification_fchown: true
audit_rules_dac_modification_fchownat: true
audit_rules_dac_modification_fremovexattr: true
audit_rules_dac_modification_fsetxattr: true
audit_rules_dac_modification_lchown: true
audit_rules_dac_modification_lremovexattr: true
audit_rules_dac_modification_lsetxattr: true
audit_rules_dac_modification_removexattr: true
audit_rules_dac_modification_setxattr: true
audit_rules_execution_chcon: true
audit_rules_execution_semanage: true
audit_rules_execution_setfiles: true
audit_rules_execution_setsebool: true
audit_rules_file_deletion_events_rename: true
audit_rules_file_deletion_events_renameat: true
audit_rules_file_deletion_events_rmdir: true
audit_rules_file_deletion_events_unlink: true
audit_rules_file_deletion_events_unlinkat: true
audit_rules_kernel_module_loading_create: true
audit_rules_kernel_module_loading_delete: true
audit_rules_kernel_module_loading_finit: true
audit_rules_kernel_module_loading_init: true
audit_rules_login_events_faillock: true
audit_rules_login_events_lastlog: true
audit_rules_login_events_tallylog: true
audit_rules_privileged_commands: true
audit_rules_privileged_commands_chage: true
audit_rules_privileged_commands_chsh: true
audit_rules_privileged_commands_crontab: true
audit_rules_privileged_commands_gpasswd: true
audit_rules_privileged_commands_newgrp: true
audit_rules_privileged_commands_pam_timestamp_check: true
audit_rules_privileged_commands_passwd: true
audit_rules_privileged_commands_postdrop: true
audit_rules_privileged_commands_postqueue: true
audit_rules_privileged_commands_ssh_keysign: true
audit_rules_privileged_commands_su: true
audit_rules_privileged_commands_sudo: true
audit_rules_privileged_commands_sudoedit: true
audit_rules_privileged_commands_umount: true
audit_rules_privileged_commands_unix_chkpwd: true
audit_rules_privileged_commands_userhelper: true
audit_rules_unsuccessful_file_modification_creat: true
audit_rules_unsuccessful_file_modification_ftruncate: true
audit_rules_unsuccessful_file_modification_open: true
audit_rules_unsuccessful_file_modification_open_by_handle_at: true
audit_rules_unsuccessful_file_modification_openat: true
audit_rules_unsuccessful_file_modification_truncate: true
audit_rules_usergroup_modification_group: true
audit_rules_usergroup_modification_gshadow: true
audit_rules_usergroup_modification_opasswd: true
audit_rules_usergroup_modification_passwd: true
audit_rules_usergroup_modification_shadow: true
auditd_audispd_encrypt_sent_records: true
auditd_data_retention_action_mail_acct: true
auditd_data_retention_space_left: true
auditd_data_retention_space_left_action: true
clean_components_post_updating: true
configure_strategy: true
dconf_gnome_banner_enabled: true
dconf_gnome_enable_smartcard_auth: true
dconf_gnome_login_banner_text: true
dconf_gnome_screensaver_idle_activation_enabled: true
dconf_gnome_screensaver_idle_delay: true
dconf_gnome_screensaver_lock_delay: true
dconf_gnome_screensaver_lock_enabled: true
dconf_gnome_screensaver_user_locks: true
dconf_gnome_session_idle_user_locks: true
dconf_use_text_backend: true
disable_ctrlaltdel_reboot: true
disable_host_auth: true
disable_strategy: true
enable_strategy: true
ensure_gpgcheck_globally_activated: true
ensure_gpgcheck_local_packages: true
file_groupowner_cron_allow: true
file_owner_cron_allow: true
file_permissions_sshd_private_key: true
file_permissions_sshd_pub_key: true
gnome_gdm_disable_automatic_login: true
gnome_gdm_disable_guest_login: true
high_complexity: true
high_disruption: true
high_severity: true
kernel_module_dccp_disabled: true
low_complexity: true
low_disruption: true
low_severity: true
medium_disruption: true
medium_severity: true
mount_option_home_nosuid: true
mount_option_krb_sec_remote_filesystems: true
mount_option_noexec_remote_filesystems: true
mount_option_nosuid_remote_filesystems: true
mount_option_nosuid_removable_partitions: true
no_empty_passwords: true
no_reboot_needed: true
package_aide_installed: true
package_screen_installed: true
package_vsftpd_removed: true
package_ypserv_removed: true
patch_strategy: true
reboot_required: true
restrict_strategy: true
rpm_verify_hashes: true
rpm_verify_ownership: true
rpm_verify_permissions: true
rsyslog_remote_loghost: true
security_patches_up_to_date: true
selinux_policytype: true
selinux_state: true
service_auditd_enabled: true
service_autofs_disabled: true
service_firewalld_enabled: true
service_kdump_disabled: true
service_sshd_enabled: true
set_password_hashing_algorithm_libuserconf: true
set_password_hashing_algorithm_logindefs: true
skip_ansible_lint: true
sshd_allow_only_protocol2: true
sshd_disable_compression: true
sshd_disable_empty_passwords: true
sshd_disable_gssapi_auth: true
sshd_disable_kerb_auth: true
sshd_disable_rhosts: true
sshd_disable_rhosts_rsa: true
sshd_disable_root_login: true
sshd_disable_user_known_hosts: true
sshd_do_not_permit_user_env: true
sshd_enable_strictmodes: true
sshd_enable_warning_banner: true
sshd_enable_x11_forwarding: true
sshd_print_last_log: true
sshd_set_idle_timeout: true
sshd_set_keepalive: true
sshd_use_approved_ciphers: true
sshd_use_approved_macs: true
sshd_use_priv_separation: true
sssd_ldap_configure_tls_ca_dir: true
sssd_ldap_start_tls: true
sysctl_kernel_randomize_va_space: true
sysctl_net_ipv4_conf_all_accept_redirects: true
sysctl_net_ipv4_conf_all_accept_source_route: true
sysctl_net_ipv4_conf_all_send_redirects: true
sysctl_net_ipv4_conf_default_accept_redirects: true
sysctl_net_ipv4_conf_default_accept_source_route: true
sysctl_net_ipv4_conf_default_send_redirects: true
sysctl_net_ipv4_icmp_echo_ignore_broadcasts: true
sysctl_net_ipv4_ip_forward: true
sysctl_net_ipv6_conf_all_accept_source_route: true
unknown_severity: true
unknown_strategy: true

# defaults file for RHEL7-CIS
rhel7stig_cat1_patch: yes
rhel7stig_cat2_patch: yes
rhel7stig_cat3_patch: yes

# We've defined complexity-high to mean that we cannot automatically remediate
# the rule in question.  In the future this might mean that the remediation
# may fail in some cases.
rhel7stig_complexity_high: no

# Show "changed" for complex items not remediated per complexity-high setting
# to make them stand out.  "changed" items on a second run of the role would
# indicate items requiring manual review.
rhel7stig_audit_complex: yes

# We've defined disruption-high to indicate items that are likely to cause
# disruption in a normal workflow.  These items can be remediated automatically
# but are disabled by default to avoid disruption.
rhel7stig_disruption_high: no

# Show "changed" for disruptive items not remediated per disruption-high
# setting to make them stand out.
rhel7stig_audit_disruptive: yes

rhel7stig_skip_for_travis: false

rhel7stig_workaround_for_disa_benchmark: true
rhel7stig_workaround_for_ssg_benchmark: true

# tweak role to run in a chroot, such as in kickstart %post script
rhel7stig_system_is_chroot: no

# tweak role to run in a non-privileged container
rhel7stig_system_is_container: no

# These variables correspond with the STIG IDs defined in the STIG and allows you to enable/disable specific rules.
# PLEASE NOTE: These work in coordination with the cat1, cat2, cat3 group variables. You must enable an entire group
# in order for the variables below to take effect.
# CAT 1 rules
rhel_07_010010: true
rhel_07_010020: true
rhel_07_010290: true
rhel_07_010300: true
rhel_07_010440: true
rhel_07_010450: true
rhel_07_010480: true
rhel_07_010482: true
rhel_07_010490: true
rhel_07_010491: true
rhel_07_020000: true
rhel_07_020010: true
rhel_07_020050: true
rhel_07_020060: true
rhel_07_020210: true
rhel_07_020220: true
rhel_07_020230: true
# Not an automated task
rhel_07_020250: true
rhel_07_020310: true
rhel_07_021350: true
rhel_07_021710: true
rhel_07_030000: true
rhel_07_032000: true
rhel_07_040390: true
rhel_07_040540: true
rhel_07_040550: true
rhel_07_040690: true
rhel_07_040700: true
rhel_07_040710: true
rhel_07_040800: true
# CAT 2 rules
rhel_07_010030: true
rhel_07_010040: true
rhel_07_010050: true
rhel_07_010060: true
rhel_07_010061: true
rhel_07_010070: true
rhel_07_010081: true
rhel_07_010082: true
rhel_07_010090: true
rhel_07_010100: true
rhel_07_010101: true
rhel_07_010110: true
rhel_07_010119: true
rhel_07_010120: true
rhel_07_010130: true
rhel_07_010140: true
rhel_07_010150: true
rhel_07_010160: true
rhel_07_010170: true
rhel_07_010180: true
rhel_07_010190: true
rhel_07_010200: true
rhel_07_010210: true
rhel_07_010220: true
rhel_07_010230: true
rhel_07_010240: true
rhel_07_010250: true
rhel_07_010260: true
rhel_07_010270: true
rhel_07_010280: true
rhel_07_010310: true
rhel_07_010320: true
rhel_07_010330: true
rhel_07_010340: true
rhel_07_010350: true
rhel_07_010430: true
rhel_07_010460: true
rhel_07_010470: true
rhel_07_010481: true
rhel_07_010500: true
rhel_07_020020: true
rhel_07_020030: true
# Send AIDE reports as mail notifications - Disabled by default as this is a non-ideal way to do notifications
rhel_07_020040: false
rhel_07_020100: true
rhel_07_020101: true
rhel_07_020110: true
rhel_07_020240: true
rhel_07_020260: true
rhel_07_020270: true
rhel_07_020320: true
rhel_07_020330: true
rhel_07_020600: true
rhel_07_020610: true
rhel_07_020620: true
rhel_07_020630: true
rhel_07_020640: true
rhel_07_020650: true
rhel_07_020660: true
rhel_07_020670: true
rhel_07_020680: true
rhel_07_020690: true
rhel_07_020700: true
rhel_07_020710: true
rhel_07_020720: true
rhel_07_020730: true
rhel_07_020900: true
rhel_07_021000: true
rhel_07_021010: true
rhel_07_021020: true
rhel_07_021021: true
rhel_07_021030: true
rhel_07_021040: true
rhel_07_021100: true
rhel_07_021110: true
rhel_07_021120: true
rhel_07_021300: true
rhel_07_021620: true
rhel_07_021700: true
rhel_07_030010: true
rhel_07_030200: true
# if you set 030300 to 'true' ensure you define rhel7stig_audisp_remote_server
rhel_07_030300: "{{ rhel7stig_audisp_remote_server is defined }}"
rhel_07_030310: true
rhel_07_030320: true
rhel_07_030321: true
rhel_07_030330: true
rhel_07_030340: true
rhel_07_030350: true
rhel_07_030360: true
rhel_07_030370: true
rhel_07_030380: true
rhel_07_030390: true
rhel_07_030400: true
rhel_07_030410: true
rhel_07_030420: true
rhel_07_030430: true
rhel_07_030440: true
rhel_07_030450: true
rhel_07_030460: true
rhel_07_030470: true
rhel_07_030480: true
rhel_07_030490: true
rhel_07_030500: true
rhel_07_030510: true
rhel_07_030520: true
rhel_07_030530: true
rhel_07_030540: true
rhel_07_030550: true
rhel_07_030560: true
rhel_07_030570: true
rhel_07_030580: true
rhel_07_030590: true
rhel_07_030610: true
rhel_07_030620: true
rhel_07_030630: true
rhel_07_030640: true
rhel_07_030650: true
rhel_07_030660: true
rhel_07_030670: true
rhel_07_030680: true
rhel_07_030690: true
rhel_07_030700: true
rhel_07_030710: true
rhel_07_030720: true
rhel_07_030740: true
rhel_07_030750: true
rhel_07_030760: true
rhel_07_030770: true
rhel_07_030780: true
rhel_07_030790: true
rhel_07_030800: true
rhel_07_030810: true
rhel_07_030819: true
rhel_07_030820: true
rhel_07_030821: true
rhel_07_030830: true
rhel_07_030840: true
rhel_07_030870: true
rhel_07_030871: true
rhel_07_030872: true
rhel_07_030873: true
rhel_07_030874: true
rhel_07_030880: true
rhel_07_030890: true
rhel_07_030900: true
rhel_07_030910: true
rhel_07_030920: true
rhel_07_031000: true
rhel_07_031010: true
rhel_07_040100: true
rhel_07_040110: true
rhel_07_040160: true
rhel_07_040170: true
rhel_07_040180: true
rhel_07_040190: true
rhel_07_040200: true
rhel_07_040201: true
rhel_07_040300: true
rhel_07_040310: true
rhel_07_040320: true
rhel_07_040330: true
rhel_07_040340: true
rhel_07_040350: true
rhel_07_040360: true
rhel_07_040370: true
rhel_07_040380: true
rhel_07_040400: true
rhel_07_040410: true
rhel_07_040420: true
rhel_07_040430: true
rhel_07_040440: true
rhel_07_040450: true
rhel_07_040460: true
rhel_07_040470: true
rhel_07_040500: true
rhel_07_040510: true
rhel_07_040520: true
rhel_07_040610: true
rhel_07_040620: true
rhel_07_040630: true
rhel_07_040640: true
rhel_07_040641: true
rhel_07_040650: true
rhel_07_040660: true
rhel_07_040670: true
rhel_07_040680: true
rhel_07_040720: true
rhel_07_040730: true
rhel_07_040740: true
rhel_07_040750: true
rhel_07_040810: true
rhel_07_040820: true
rhel_07_040830: true
rhel_07_041001: true
rhel_07_041002: true
rhel_07_041003: true
rhel_07_041010: true
# CAT 3 rules
rhel_07_020200: true
rhel_07_020300: true
rhel_07_021022: true
rhel_07_021023: true
rhel_07_021024: true
rhel_07_021310: true
rhel_07_021320: true
rhel_07_021330: true
rhel_07_021340: true
rhel_07_021600: true
rhel_07_021610: true
rhel_07_040000: true
rhel_07_040530: true
rhel_07_040600: true

# Whether or not to run tasks related to auditing/patching the desktop environment
rhel7stig_gui: no

# RHEL-07-020250
# This is a check for a "supported release"
# These are the minimum supported releases.
# (Red Hat has support for older versions if you pay extra for it.)
rhel7stig_min_supported_os_ver:
    RedHat: "7.5"
    CentOS: "7.4.1708"

# RHEL-07-040740
# If system is not router, run tasks that disable router functions.
rhel7stig_system_is_router: no

# RHEL-07-032000
# Install and enable a DOD-approved AV program. ClamAV and McAfee (nails)
# are the currently approved applications. This variable is used in two separate
# tasks that will install the package and start and enable the service.

# Only set this to true if you have a valid
# antivirus solution in your repositories, else it will fail every time.
rhel7stig_antivirus_required: no

rhel7stig_av_package:
    package:
        - clamav
        - clamav-scanner
        - clamav-server
    service: clamav-daemon

rhel7stig_time_service: ntpd
rhel7stig_time_service_configs:
    chronyd:
        conf: /etc/chrony.conf
        block: |
          server 0.rhel.pool.ntp.org iburst maxpoll 10
          server 1.rhel.pool.ntp.org iburst maxpoll 10
          server 2.rhel.pool.ntp.org iburst maxpoll 10
          server 3.rhel.pool.ntp.org iburst maxpoll 10
    ntpd:
        conf: /etc/ntp.conf
        lines:
            - regexp: ^#?maxpoll
              line: maxpoll 10

rhel7stig_firewall_service: firewalld

# RHEL-07-031010
rhel7stig_system_is_log_aggregator: false

# RHEL-07-040300
# RHEL-07-040310
# Install and enable ssh on networked systems
rhel7stig_ssh_required: yes

# RHEL-07-040490
# If not required, remove vsftpd.
rhel7stig_vsftpd_required: no

# RHEL-07-040500
# If not required, remove tftp
rhel7stig_tftp_required: no

# Service configuration booleans set true to keep service
rhel7stig_autofs_required: false
rhel7stig_kdump_required: false

# RHEL-07-040580
# Set the SNMP community string to this from the default of public or private
rhel7stig_snmp_community: Endgam3Ladyb0g

# RHEL-07-010480 and RHEL-07-010490
# Password protect the boot loader
rhel7stig_bootloader_password: 'Boot1tUp!'
rhel7stig_bootloader_password_hash: "{{ rhel7stig_bootloader_password | grub2_hash(salt='KeokpkECTJeoDhEA5XtiLQ') }}"
rhel7stig_boot_superuser: root
rhel7stig_boot_password_config:
    - regexp: ^set superusers
      line: 'set superusers="{{rhel7stig_boot_superuser}}"'

    - regexp: ^password_pbkdf2 {{rhel7stig_boot_superuser}}
      line: password_pbkdf2 {{rhel7stig_boot_superuser}} {{ rhel7stig_bootloader_password_hash }}

# AIDE settings
# Set to false for fire and forget mode
rhel7stig_wait_for_aide_init: true
rhel7stig_aide_handler: "{{ (rhel7stig_wait_for_aide_init) | ternary('init aide and wait','init aide') }}"

# Set to false to not overwrite an existing AIDE DB
rhel7stig_overwrite_aide_db: true

# AIDE database file locations
rhel7stig_aide_temp_db_file: /var/lib/aide/aide.db.new.gz
rhel7stig_aide_db_file: /var/lib/aide/aide.db.gz

rhel7stig_aide_cron:
    user: root
    cron_file: aide
    job: '/usr/sbin/aide --check'
    special_time: daily
    # Disable the notification check rule to disable mailing notifications
    notify_by_mail: "{{rhel_07_020040}}"
    notify_cmd: ' | /bin/mail -s "$HOSTNAME - Daily aide integrity check run" root'

rhel7stig_cron_special_disable: "{{
        rhel7stig_workaround_for_disa_benchmark or
        rhel7stig_workaround_for_ssg_benchmark or
        false }}"

rhel7stig_aide_conf:
    file: /etc/aide.conf

# Set maximum number of simultaneous system logins (RHEL-07-040000)
rhel7stig_maxlogins: 10

rhel7stig_logon_banner: |
    You are accessing a U.S. Government (USG) Information System (IS) that is
    provided for USG-authorized use only.
    By using this IS (which includes any device attached to this IS), you consent
    to the following conditions:
    -The USG routinely intercepts and monitors communications on this IS for
    purposes including, but not limited to, penetration testing, COMSEC monitoring,
    network operations and defense, personnel misconduct (PM), law enforcement
    (LE), and counterintelligence (CI) investigations.
    -At any time, the USG may inspect and seize data stored on this IS.
    -Communications using, or data stored on, this IS are not private, are subject
    to routine monitoring, interception, and search, and may be disclosed or used
    for any USG-authorized purpose.
    -This IS includes security measures (e.g., authentication and access controls)
    to protect USG interests--not for your personal benefit or privacy.
    -Notwithstanding the above, using this IS does not constitute consent to PM, LE
    or CI investigative searching or monitoring of the content of privileged
    communications, or work product, related to personal representation or services
    by attorneys, psychotherapists, or clergy, and their assistants. Such
    communications and work product are private and confidential. See User
    Agreement for details.
# Password complexity settings
rhel7stig_password_complexity:
    ucredit: -1
    lcredit: -1
    dcredit: -1
    ocredit: -1
    difok: 8
    minclass: 4
    maxrepeat: 3
    maxclassrepeat: 4
    minlen: 15

# RHEL-07-040160
# Session timeout setting file (TMOUT setting can be set in multiple files)
# Timeout value is in seconds. (60 seconds * 10 = 600)
rhel7stig_shell_session_timeout:
    file: /etc/profile.d/tmout.sh
    timeout: 600

# RHEL-07-040320 | All network connections associated with SSH traffic must
# terminate at the end of the session or after 10 minutes of inactivity, except
# to fulfill documented and validated mission requirements.
# Timeout value is in seconds. (60 seconds * 10 = 600)
rhel7stig_ssh_session_timeout: 600

# RHEL-07-020260
# Configure regular automatic package updates using yum-cron
# update_cmd options:
# default                            = yum upgrade
# security                           = yum --security upgrade
# security-severity:Critical         = yum --sec-severity=Critical upgrade
# minimal                            = yum --bugfix upgrade-minimal
# minimal-security                   = yum --security upgrade-minimal
# minimal-security-severity:Critical =  --sec-severity=Critical upgrade-minimal
rhel7stig_auto_package_updates_enabled: no
rhel7stig_auto_package_updates:
    enabled: "{{ rhel7stig_auto_package_updates_enabled }}"
    update_cmd: "minimal-security"
    frequency: daily

# RHEL-07-020270
# If vsftpd is required, remove 'ftp' from rhel7stig_unnecessary_accounts.
#
# By default, files owned by removed users will be retained, but this may
# trigger RHEL-07-020320 (all files and directories must have a valid owner).
# Set rhel7stig_remove_unnecessary_user_files to yes to remove old files,
# but this could remove files you intended to keep. And it's probably best to
# avoid removing 'dbus', 'nobody', 'systemd-network', and 'polkitd', as they all
# have home directories of '/' by default.
rhel7stig_unnecessary_accounts:
    - ftp
    - games
rhel7stig_remove_unnecessary_user_files: no

# RHEL-07-010270
# pam_pwhistory settings - Verify the operating system prohibits password reuse for a minimum of five generations.
rhel7stig_pam_pwhistory:
    remember: 5
    retries: 3

# RHEL-07-010320
# RHEL-07-010330
# pam_faillock settings - accounts must be locked for max time period after 3 unsuccessful attempts within 15 minutes.
rhel7stig_pam_faillock:
    attempts: 3
    interval: 900
    unlock_time: 900
    fail_for_root: yes

# RHEL-07-030320 and RHEL-07-030321
rhel7stig_audisp_disk_full_action: syslog
rhel7stig_audisp_network_failure_action: syslog

# RHEL-07-040670
# Network interface promiscuous mode setting will be disabled unless set to true
rhel7stig_net_promisc_mode_required: no

# /etc/login.defs settings
# RHEL-07-010210
# RHEL-07-010230
# RHEL-07-010250
# RHEL-07-010430
# RHEL-07-020240
# RHEL-07-020610
rhel7stig_login_defaults:
    encrypt_method: SHA512
    pass_min_days: 1
    pass_max_days: 60
    fail_delay_secs: 4
    umask: '077'
    create_home: 'yes'

# RHEL-07-030300 uncomment and set the value to a remote IP address that can receive audit logs
# rhel7stig_audisp_remote_server: 10.10.10.10

# RHEL-07-030330: set this to 25% of the free space in /var/log/audit (measured in megabytes)
rhel7stig_auditd_space_left: "{{ ( ansible_mounts | json_query(rhel7stig_audit_disk_size_query) | int / 4 / 1024 / 1024 ) | int + 1 }}"
rhel7stig_audit_disk_size_query: "[?mount=='{{ rhel7stig_audit_part }}'].size_total | [0]"

# RHEL-07-030350
rhel7stig_auditd_mail_acct: root

# RHEL-07-020630
rhel7stig_homedir_mode: g-w,o-rwx

# RHEL-07-031000
# rhel7stig_log_aggregation_server: logagg.example.com

# RHEL-07-040180
# Whether the system should be using LDAP for authentication
rhel7stig_auth_settings:
    use_ldap: no
    use_sssd: no

# RHEL-07-040820
rhel7stig_ipsec_required: no

# RHEL-07-010340
# Setting to enable or disable fixes that depend on password-based authentication
# i.e. if users authenticate with a means other than passwords (pubkey)
# and will not know or use passwords then this should be 'no'
rhel7stig_using_password_auth: yes

rhel7stig_availability_override: false
# auditd_failure_flag
# 2    Tells your system to perform an immediate shutdown without
#      flushing any pending data to disk when the limits of your
#      audit system are exceeded. Because this shutdown is not a clean shutdown.
#      restrict the use of -f 2 to only the most security conscious environments
# 1    System continues to run, issues a warning and audit stops.
#      Use this for any other setup to avoid loss of data or data corruption.
rhel7stig_auditd_failure_flag: "{{ rhel7stig_availability_override | ternary(1, 2) }}"

rhel7stig_audit_part: "{{ rhel_07_audit_part.stdout }}"

rhel7stig_boot_part: "{{ rhel_07_boot_part.stdout }}"

rhel7stig_machine_uses_uefi: "{{ rhel_07_sys_firmware_efi.stat.exists }}"
rhel7stig_grub_cfg_path: "{{ rhel7stig_machine_uses_uefi | ternary('/boot/efi/EFI/{{ ansible_distribution | lower }}/grub.cfg', '/boot/grub2/grub.cfg') }}"

rhel7stig_passwd_label: "{{ (this_item | default(item)).id }}: {{ (this_item | default(item)).dir }}"

rhel7stig_local_mounts: "{{ ansible_mounts | to_json | from_json | json_query(rhel7stig_local_mounts_query) }}"
rhel7stig_local_mounts_query: "[?starts_with(device, '/dev/')].mount"

rhel7stig_nfs_mounts: "{{ ansible_mounts | to_json | from_json | json_query(rhel7stig_nfs_mounts_query) }}"
rhel7stig_nfs_mounts_query: "[?starts_with(fstype, 'nfs')].mount"


rhel7cis_skip_for_travis: false

rhel7cis_notauto: false
rhel7cis_section1: true
rhel7cis_section2: true
rhel7cis_section3: true
rhel7cis_section4: true
rhel7cis_section5: true
rhel7cis_section6: true

rhel7cis_selinux_disable: false

# These variables correspond with the CIS rule IDs or paragraph numbers defined in
# the CIS benchmark documents.
# PLEASE NOTE: These work in coordination with the section # group variables and tags.
# You must enable an entire section in order for the variables below to take effect.
# Section 1 rules
rhel7cis_rule_1_1_1_1: true
rhel7cis_rule_1_1_1_2: true
rhel7cis_rule_1_1_1_3: true
rhel7cis_rule_1_1_1_4: true
rhel7cis_rule_1_1_1_5: true
rhel7cis_rule_1_1_1_6: true
rhel7cis_rule_1_1_1_7: true
rhel7cis_rule_1_1_1_8: true
rhel7cis_rule_1_1_2: true
rhel7cis_rule_1_1_3: true
rhel7cis_rule_1_1_4: true
rhel7cis_rule_1_1_5: true
rhel7cis_rule_1_1_6: true
rhel7cis_rule_1_1_7: true
rhel7cis_rule_1_1_8: true
rhel7cis_rule_1_1_9: true
rhel7cis_rule_1_1_10: true
rhel7cis_rule_1_1_11: true
rhel7cis_rule_1_1_12: true
rhel7cis_rule_1_1_13: true
rhel7cis_rule_1_1_14: true
rhel7cis_rule_1_1_15: true
rhel7cis_rule_1_1_16: true
rhel7cis_rule_1_1_17: true
rhel7cis_rule_1_1_18: true
rhel7cis_rule_1_1_19: true
rhel7cis_rule_1_1_20: true
rhel7cis_rule_1_1_21: true
rhel7cis_rule_1_1_22: true
rhel7cis_rule_1_2_1: true
rhel7cis_rule_1_2_2: true
rhel7cis_rule_1_2_3: true
rhel7cis_rule_1_2_4: true
rhel7cis_rule_1_2_5: true
rhel7cis_rule_1_3_1: true
rhel7cis_rule_1_3_2: true
rhel7cis_rule_1_4_1: true
rhel7cis_rule_1_4_2: true
rhel7cis_rule_1_4_3: true
rhel7cis_rule_1_5_1: true
rhel7cis_rule_1_5_2: true
rhel7cis_rule_1_5_3: true
rhel7cis_rule_1_5_4: true
rhel7cis_rule_1_6_1_1: true
rhel7cis_rule_1_6_1_2: true
rhel7cis_rule_1_6_1_3: true
rhel7cis_rule_1_6_1_4: true
rhel7cis_rule_1_6_1_5: true
rhel7cis_rule_1_6_2: true
rhel7cis_rule_1_7_1_1: true
rhel7cis_rule_1_7_1_2: true
rhel7cis_rule_1_7_1_3: true
rhel7cis_rule_1_7_1_4: true
rhel7cis_rule_1_7_1_5: true
rhel7cis_rule_1_7_1_6: true
rhel7cis_rule_1_7_2: true
rhel7cis_rule_1_8: true

# Section 2 rules
rhel7cis_rule_2_1_1: true
rhel7cis_rule_2_1_2: true
rhel7cis_rule_2_1_3: true
rhel7cis_rule_2_1_4: true
rhel7cis_rule_2_1_5: true
rhel7cis_rule_2_1_6: true
rhel7cis_rule_2_1_7: true
rhel7cis_rule_2_2_1_1: true
rhel7cis_rule_2_2_1_2: true
rhel7cis_rule_2_2_1_3: true
rhel7cis_rule_2_2_2: true
rhel7cis_rule_2_2_3: true
rhel7cis_rule_2_2_4: true
rhel7cis_rule_2_2_5: true
rhel7cis_rule_2_2_6: true
rhel7cis_rule_2_2_7: true
rhel7cis_rule_2_2_8: true
rhel7cis_rule_2_2_9: true
rhel7cis_rule_2_2_10: true
rhel7cis_rule_2_2_11: true
rhel7cis_rule_2_2_12: true
rhel7cis_rule_2_2_13: true
rhel7cis_rule_2_2_14: true
rhel7cis_rule_2_2_15: true
rhel7cis_rule_2_2_16: true
rhel7cis_rule_2_2_17: true
rhel7cis_rule_2_2_18: true
rhel7cis_rule_2_2_19: true
rhel7cis_rule_2_2_20: true
rhel7cis_rule_2_2_21: true
rhel7cis_rule_2_3_1: true
rhel7cis_rule_2_3_2: true
rhel7cis_rule_2_3_3: true
rhel7cis_rule_2_3_4: true
rhel7cis_rule_2_3_5: true

# Section 3 rules
rhel7cis_rule_3_1_1: true
rhel7cis_rule_3_1_2: true
rhel7cis_rule_3_2_1: true
rhel7cis_rule_3_2_2: true
rhel7cis_rule_3_2_3: true
rhel7cis_rule_3_2_4: true
rhel7cis_rule_3_2_5: true
rhel7cis_rule_3_2_6: true
rhel7cis_rule_3_2_7: true
rhel7cis_rule_3_2_8: true
rhel7cis_rule_3_3_1: true
rhel7cis_rule_3_3_2: true
rhel7cis_rule_3_3_3: true
rhel7cis_rule_3_4_1: true
rhel7cis_rule_3_4_2: true
rhel7cis_rule_3_4_3: true
rhel7cis_rule_3_4_4: true
rhel7cis_rule_3_4_5: true
rhel7cis_rule_3_5_1: true
rhel7cis_rule_3_5_2: true
rhel7cis_rule_3_5_3: true
rhel7cis_rule_3_5_4: true
rhel7cis_rule_3_6_1: true
rhel7cis_rule_3_6_2: true
rhel7cis_rule_3_6_3: true
rhel7cis_rule_3_6_4: true
rhel7cis_rule_3_6_5: true

# Section 4 rules
rhel7cis_rule_4_1_1_1: true
rhel7cis_rule_4_1_1_2: true
rhel7cis_rule_4_1_1_3: true
rhel7cis_rule_4_1_2: true
rhel7cis_rule_4_1_3: true
rhel7cis_rule_4_1_4: true
rhel7cis_rule_4_1_5: true
rhel7cis_rule_4_1_6: true
rhel7cis_rule_4_1_7: true
rhel7cis_rule_4_1_8: true
rhel7cis_rule_4_1_9: true
rhel7cis_rule_4_1_10: true
rhel7cis_rule_4_1_11: true
rhel7cis_rule_4_1_12: true
rhel7cis_rule_4_1_13: true
rhel7cis_rule_4_1_14: true
rhel7cis_rule_4_1_15: true
rhel7cis_rule_4_1_16: true
rhel7cis_rule_4_1_17: true
rhel7cis_rule_4_1_18: true
rhel7cis_rule_4_2_3: true
rhel7cis_rule_4_2_1_1: true
rhel7cis_rule_4_2_1_2: true
rhel7cis_rule_4_2_1_3: true
rhel7cis_rule_4_2_1_4: true
rhel7cis_rule_4_2_1_5: true
rhel7cis_rule_4_2_2_1: true
rhel7cis_rule_4_2_2_2: true
rhel7cis_rule_4_2_2_3: true
rhel7cis_rule_4_2_2_4: true
rhel7cis_rule_4_2_2_5: true
rhel7cis_rule_4_2_4: true

# Section 5 rules
rhel7cis_rule_5_1_1: true
rhel7cis_rule_5_1_2: true
rhel7cis_rule_5_1_3: true
rhel7cis_rule_5_1_4: true
rhel7cis_rule_5_1_5: true
rhel7cis_rule_5_1_6: true
rhel7cis_rule_5_1_7: true
rhel7cis_rule_5_1_8: true
rhel7cis_rule_5_2_1: true
rhel7cis_rule_5_2_2: true
rhel7cis_rule_5_2_3: true
rhel7cis_rule_5_2_4: true
rhel7cis_rule_5_2_5: true
rhel7cis_rule_5_2_6: true
rhel7cis_rule_5_2_7: true
rhel7cis_rule_5_2_8: true
rhel7cis_rule_5_2_9: true
rhel7cis_rule_5_2_10: true
rhel7cis_rule_5_2_11: true
rhel7cis_rule_5_2_12: true
rhel7cis_rule_5_2_13: true
rhel7cis_rule_5_2_14: true
rhel7cis_rule_5_2_15: true
rhel7cis_rule_5_2_16: true
rhel7cis_rule_5_3_1: true
rhel7cis_rule_5_3_2: true
rhel7cis_rule_5_3_3: true
rhel7cis_rule_5_3_4: true
rhel7cis_rule_5_4_1_1: true
rhel7cis_rule_5_4_1_2: true
rhel7cis_rule_5_4_1_3: true
rhel7cis_rule_5_4_1_4: true
rhel7cis_rule_5_4_2: true
rhel7cis_rule_5_4_3: true
rhel7cis_rule_5_4_4: true

# Section 6 rules
rhel7cis_rule_6_1_1: true
rhel7cis_rule_6_1_2: true
rhel7cis_rule_6_1_3: true
rhel7cis_rule_6_1_4: true
rhel7cis_rule_6_1_5: true
rhel7cis_rule_6_1_6: true
rhel7cis_rule_6_1_7: true
rhel7cis_rule_6_1_8: true
rhel7cis_rule_6_1_9: true
rhel7cis_rule_6_1_10: true
rhel7cis_rule_6_1_11: true
rhel7cis_rule_6_1_12: true
rhel7cis_rule_6_1_13: true
rhel7cis_rule_6_1_14: true
rhel7cis_rule_6_2_1: true
rhel7cis_rule_6_2_2: true
rhel7cis_rule_6_2_3: true
rhel7cis_rule_6_2_4: true
rhel7cis_rule_6_2_5: true
rhel7cis_rule_6_2_6: true
rhel7cis_rule_6_2_7: true
rhel7cis_rule_6_2_8: true
rhel7cis_rule_6_2_9: true
rhel7cis_rule_6_2_10: true
rhel7cis_rule_6_2_11: true
rhel7cis_rule_6_2_12: true
rhel7cis_rule_6_2_14: true
rhel7cis_rule_6_2_15: true
rhel7cis_rule_6_2_16: true
rhel7cis_rule_6_2_17: true
rhel7cis_rule_6_2_18: true
rhel7cis_rule_6_2_19: true

# Service configuration booleans set true to keep service
rhel7cis_avahi_server: false
rhel7cis_cups_server: false
rhel7cis_dhcp_server: false
rhel7cis_ldap_server: false
rhel7cis_telnet_server: false
rhel7cis_nfs_server: false
rhel7cis_rpc_server: false
rhel7cis_ntalk_server: false
rhel7cis_rsyncd_server: false
rhel7cis_tftp_server: false
rhel7cis_rsh_server: false
rhel7cis_nis_server: false
rhel7cis_snmp_server: false
rhel7cis_squid_server: false
rhel7cis_smb_server: false
rhel7cis_dovecot_server: false
rhel7cis_httpd_server: false
rhel7cis_vsftpd_server: false
rhel7cis_named_server: false
rhel7cis_nfs_rpc_server: false
rhel7cis_is_mail_server: false
rhel7cis_bind: false
rhel7cis_vsftpd: false
rhel7cis_httpd: false
rhel7cis_dovecot: false
rhel7cis_samba: false
rhel7cis_squid: false
rhel7cis_net_snmp: false
rhel7cis_allow_autofs: false

# xinetd required
rhel7cis_xinetd_required: false

# RedHat Satellite Subscription items
rhel7cis_rhnsd_required: false

# 1.4.2 Bootloader password
rhel7cis_bootloader_password: random
rhel7cis_set_boot_pass: true

# System network parameters (host only OR host and router)
rhel7cis_is_router: false

# IPv6 required
rhel7cis_ipv6_required: true

# AIDE
rhel7cis_config_aide: true
# AIDE cron settings
rhel7cis_aide_cron:
  cron_user: root
  cron_file: /etc/crontab
  aide_job: '/usr/sbin/aide --check'
  aide_minute: 0
  aide_hour: 5
  aide_day: '*'
  aide_month: '*'
  aide_weekday: '*'

# SELinux policy
rhel7cis_selinux_pol: targeted

# Whether or not to run tasks related to auditing/patching the desktop environment
rhel7cis_gui: no

# Set to 'true' if X Windows is needed in your environment
rhel7cis_xwindows_required: no

rhel7cis_openldap_clients_required: false
rhel7cis_telnet_required: false
rhel7cis_talk_required: false
rhel7cis_rsh_required: false
rhel7cis_ypbind_required: false

# Time Synchronization
#rhel7cis_time_synchronization: chrony
rhel7cis_time_synchronization: ntp

rhel7cis_time_synchronization_servers:
    - 0.pool.ntp.org
    - 1.pool.ntp.org
    - 2.pool.ntp.org
    - 3.pool.ntp.org

#rhel7cis_chrony_server_options: "minpoll 8"
rhel7cis_ntp_server_options: "iburst"

# 3.4.2 | PATCH | Ensure /etc/hosts.allow is configured
rhel7cis_host_allow:
    - "10.0.0.0/255.0.0.0"
    - "172.16.0.0/255.240.0.0"
    - "192.168.0.0/255.255.0.0"
    - "128.0.0.0/128.0.0.0" #temporary for testing
    - "0.0.0.0/128.0.0.0" #temporary for testing

#rhel7cis_firewall: firewalld
rhel7cis_firewall: iptables

rhel7cis_firewall_services:
    - ssh
    - dhcpv6-client

# Warning Banner Content (issue, issue.net, motd)
rhel7cis_warning_banner: |
    Authorized uses only. All activity may be monitored and reported.
# End Banner

## Section4 vars

rhel7cis_auditd:
    admin_space_left_action: halt
    max_log_file_action: keep_logs

rhel7cis_logrotate: "daily"

## Section5 vars

rhel7cis_sshd:
    clientalivecountmax: 3
    clientaliveinterval: 300
    ciphers: "aes256-ctr,aes192-ctr,aes128-ctr"
    macs: "hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-512,hmac-sha2-256,umac-128@openssh.com"
    logingracetime: 60
    # - make sure you understand the precedence when working with these values!!
    #allowusers:
    #allowgroups: systems dba
    #denyusers:
    #denygroups:

rhel7cis_pass:
    max_days: 90
    min_days: 7
    warn_age: 7
# Syslog system
rhel7cis_syslog: rsyslog
#rhel7cis_syslog: syslog-ng

rhel7cis_vartmp:
    source: /tmp
    fstype: none
    opts: "defaults,nodev,nosuid,noexec,bind"
    enabled: yes

rhel7cis_rule_5_4_2_min_uid: 1000

###############################################
# Values which modify the behaviour of the role
###############################################

cis_apply_level_1_profile: true    # Whether Level 1 of the benchmark should be applied
cis_apply_level_2_profile: true    # Whether Level 2 of the benchmark should be applied

cis_level_1_exclusions: ['1.2.3','1.8','3.4.2','3.4.3']         # A list of Level 1 recommendations to exclude (i.e. ['1.1.1.1'])
#cis_level_1_exclusions: ['1.2.3','1.8']
cis_level_2_exclusions: ['6.1.1']         # A list of Level 2 recommendations to exclude

# Whether to fail when remediation items are found for recommendations which can't be automatically fixed.
# If false, a debug message will be generated instead, with the preface *** ACTION REQUIRED ***..
fail_on_manual_remediation_actions: false  # True or false.

###############################################
# Check specific values which can be overridden
###############################################

# 1.3.1
cis_aide_database_filename: "/var/lib/aide/aide.db.gz"
cis_aide_src_database_filename: "/var/lib/aide/aide.db.new.gz"

# 1.3.2
cis_aide_cron_user: "root"
cis_aide_cron_job: "/usr/sbin/aide --check"
cis_aide_cron_minute: 0
cis_aide_cron_hour: 5
cis_aide_cron_dow: "*" # Day of week
cis_aide_cron_dom: "*" # Day of month
cis_aide_cron_month: "*"

# 1.7.1.2
cis_local_login_warning_banner: "Authorized uses only. All activity may be monitored and reported.\n"
# 1.7.1.3
cis_remote_login_warning_banner: "Authorized uses only. All activity may be monitored and reported.\n"

# 2.1.1
cis_chargen_exception:
cis_chargen_state: stopped

# 2.1.2
cis_daytime_exception:
cis_daytime_state: stopped

# 2.1.3
cis_discard_exception:
cis_discard_state: stopped

# 2.1.4
cis_echo_exception:
cis_echo_state: stopped

# 2.1.5
cis_time_exception:
cis_time_state: stopped

# 2.1.6
cis_rservices_install: { package: rsh-server, state: absent, rshserver_exception: }
cis_rservice_rexec: { service: rexec.socket, enabled: no, state: stopped, rexec_exception: }
cis_rservice_rlogin: { service: rlogin.socket, enabled: no, state: stopped, rlogin_exeception: }
cis_rservice_rsh: { service: rsh.socket, enabled: no, state: stopped, rlogin_exeception: }

# 2.1.7
cis_talkd_install: { package: talk-server, state: absent, exception: 123, service: talk.socket, enabled: no, rstate: started, client: talk, client_state: absent }

# 2.1.8
cis_telnet_install: { package: telnet-server, state: absent, exception: 123, service: telnet.socket, enabled: no, rstate: started, client: telnet, client_state: present }

# 2.1.9
cis_tftp_install: { package: tftp-server, state: absent, exception: 123, service: tftp.socket, enabled: no, rstate: started, client: tftp, client_state: present }

# 2.1.10
cis_rsync_install: { package: rsync, state: absent, exception: 123, service: rsyncd, enabled: no, rstate: started }

# 2.1.11  # NOTE NEED TO SET XINETD STATE IN TWO PLACES BELOW
cis_xinetd_install: { package: xinetd, state: absent, exception: 123, service: xinetd, enabled: no, rstate: started }
cis_xinetd_state: absent # Set state to absent if not needed, enables conditional pass for basic services e.g. chargen

# 2.2.1.1
# You should only enable either ntp or chrony, but not both.
cis_enable_ntp: true # Set to true if ntp should be enabled/configured.
cis_enable_chrony: false # Set to true if chrony should be enabled/configured.

# 2.2.1.2
# Enter the variables for configuring NTP
# NTP
cis_ntp_clients: |+
  server 0.pool.ntp.org
  server 1.pool.ntp.org
  server 2.pool.ntp.org
  server 3.pool.ntp.org

cis_ntp_servers: |+
  peer ntp1.company.com
  restrict ntp1-1.company.com mask 255.255.255.255 nomodify notrap
  peer ntp2.xpo.com
  restrict ntp1-2.company.com mask 255.255.255.255 nomodify notrap
  peer ntp3.xpo.com
  restrict ntp1-3.company.com mask 255.255.255.255 nomodify notrap

# 2.2.1.3
# Enter the variables for configurating Chronyd Server
# Chronyd
cis_chrony_servers: |+
  server 0.pool.ntp.org
  server 1.pool.ntp.org
  server 2.pool.ntp.org
  server 3.pool.ntp.org

# 2.2.2
# Installation of X-Windows
cis_xwindows_install: { package: "xorg-x11*", state: absent, exception: 123 }

# 2.2.3
# Installation of Avahi Daemon NOTE: Avahi service will not start without further configuration
cis_avahi_install: { package: "avahi", state: absent, service: avahi-daemon, rstate: started, enabled: false, exception: 123 }

# 2.2.4
# Installation of CUPS
cis_cups_install: { package: "cups", state: absent, service: cups, rstate: started, enabled: false, exception: 123 }

# 2.2.5
# Installation of DHCP Service
cis_dhcpd_install: { package: "dhcp", state: absent, service: dhcpd, rstate: stopped, enabled: false, exception: 123 }

# 2.2.6
# Installation of LDAP Server
cis_slapd_install: { package: "openldap-servers", state: absent, service: slapd, rstate: started, enabled: false, exception: 123 }

# 2.2.7
# Installation of NFS and RPC Services, NOTE: RPC Bind Service will only be started if NFS is present
cis_nfs_install: { package: nfs-utils, state: absent, service: nfs-server, rstate: started, enabled: true, exception: 123 }
cis_rpcbind_install: { package: rpcbind, state: absent, service: rpcbind, rstate: started, enabled: true, exception: 123 }

# 2.2.8
# Installation of DNS Bind, named service, NOTE: there are other Bind Services available if want to subsitute
cis_named_install: { package: bind-chroot, state: absent, service: named, rstate: started, enabled: true, exception: 123 }

# 2.2.9
# Installation of FTP Server, vsftpd
cis_vsftpd_install: { package: vsftpd, state: absent, service: vsftpd, rstate: started, enabled: true, exception: 123 }

# 2.2.10
# Installation of various HTTP Servers NOTE: Select one of the below
cis_httpd_install: { package: httpd, state: absent, service: httpd, rstate: started, enabled: true, exception: 123 }
cis_apache_install: { package: apache, state: absent, service: apache, rstate: started, enabled: true, exception: 123 }
cis_apache2_install: { package: apache2, state: absent, service: apache2, rstate: started, enabled: true, exception: 123 }
cis_nginx_install: { package: nginx, state: absent, service: nginx, rstate: started, enabled: true, exception: 123 }
cis_lighttpd_install: { package: lighttpd, state: absent, service: lighttpd, rstate: started, enabled: true, exception: 123 }

# 2.2.11
# Installation of POP3 and IMAP Services
cis_dovecot_install: { package: dovecot, state: absent, service: dovecot, rstate: started, enabled: true, exception: 123 }
cis_cyrus_imapd_install: { package: cyrus-imapd, state: absent, service: cyrus-imapd, rstate: started, enabled: true, exception: 123 }

# 2.2.12
# Installation of SMB, SAMBA Services
cis_smb_install: { package: samba, state: absent, service: smb, rstate: started, enabled: true, exception: 123 }

# 2.2.13
# Installation of Squid Services
cis_squid_install: { package: squid, state: absent, service: squid, rstate: started, enabled: true, exception: 123 }

# 2.2.14
# Installation of SNMP Service
cis_snmp_install: { package: net-snmp, state: absent, service: snmpd, rstate: started, enabled: true, exception: 123 }
# SNMP Configuration
cis_snmp_community: cis_test
cis_snmp_syscontact: admin@domain.com
cis_snmp_syslocation: XXXXXXX Datacenter

cis_snmp_servers:
  - { server: snmp01.domain.com, community: "{{ cis_snmp_community }}" }
  - { server: snmp02.domain.com, community: "{{ cis_snmp_community }}" }
  - { server: snmp03.domain.com, community: "{{ cis_snmp_community }}" }
  - { server: snmp04.domain.com, community: "{{ cis_snmp_community }}" }
  - { server: localhost.localdomain, community: "{{ cis_snmp_community }}" }

cis_snmp_trapsink:
  - { server: trapsink01.domain.com, community: "{{ cis_snmp_community }}" }
  - { server: trapsink02.domain.com, community: "{{ cis_snmp_community }}" }

# 2.2.16
# Installation of NIS Service
cis_nis_install: { package: ypserv, state: absent, service: ypserv, rstate: started, enabled: true, exception: 123 }

# 3.1.1
cis_v_3_1_1_ipv4_ip_forward: { proc_src: '/proc/sys/net/ipv4/ip_forward', kernel_param: 'net.ipv4.ip_forward', value: 0 }
#v_3_1_1_ipv4_route_flush: { proc_src: '/proc/sys/net/ipv4/route/flush', kernel_param: 'net.ipv4.route.flush', value: 1}

# 3.1.2
cis_v_3_1_2_ipv4_conf_all_send_redirects: { proc_src: '/proc/sys/net/ipv4/conf/all/send_redirects', kernel_param: 'net.ipv4.conf.all.send_redirects', value: 0 }
cis_v_3_1_2_ipv4_conf_default_send_redirects: { proc_src: '/proc/sys/net/ipv4/conf/default/send_redirects', kernel_param: 'net.ipv4.conf.default.send_redirects', value: 0 }
#v_3_1_2_ipv4_ipv4_route_flush: { proc_src: '/proc/sys/net/ipv4/route/flush', kernel_param: 'net.ipv4.route.flush', value: 1 }

# 3.2.1
cis_v_3_2_1_ipv4_conf_all_accept_source_route: { proc_src: '/proc/sys/net/ipv4/conf/all/accept_source_route', kernel_param: 'net.ipv4.conf.all.accept_source_route', value: 0 }
cis_v_3_2_1_ipv4_conf_default_accept_source_route: { proc_src: '/proc/sys/net/ipv4/conf/default/accept_source_route', kernel_param: 'net.ipv4.conf.default.accept_source_route', value: 0 }
#v_3_2_1_ipv4_route_flush: { proc_src: '/proc/sys/net/ipv4/route/flush', kernel_param: 'flush', value: 1 }

# 3.2.2
cis_v_3_2_2_ipv4_conf_all_accept_redirects: { proc_src: '/proc/sys/net/ipv4/conf/all/accept_redirects', kernel_param: 'net.ipv4.conf.all.accept_redirects', value: 0 }
cis_v_3_2_2_ipv4_conf_default_accept_redirects: { proc_src: '/proc/sys/net/ipv4/conf/default/accept_redirects', kernel_param: 'net.ipv4.conf.default.accept_redirects', value: 0 }
cis_v_3_2_2_ipv4_route_flush: { proc_src: '/proc/sys/net/ipv4/route/flush', kernel_param: 'flush', value: 1 }

# 3.2.3
cis_v_3_2_3_ipv4_conf_all_secure_redirects: { proc_src: '/proc/sys/net/ipv4/conf/all/secure_redirects', kernel_param: 'net.ipv4.conf.all.secure_redirects', value: 0 }
cis_v_3_2_3_ipv4_conf_default_secure_redirects: { proc_src: '/proc/sys/net/ipv4/conf/default/secure_redirects', kernel_param: 'net.ipv4.conf.default.secure_redirects', value: 0 }
cis_v_3_2_3_ipv4_route_flush: { proc_src: '/proc/sys/net/ipv4/route/flush', kernel_param: 'flush', value: 1 }

# 3.2.4
cis_v_3_2_4_ipv4_conf_all_log_martians: { proc_src: '/proc/sys/net/ipv4/conf/all/log_martians', kernel_param: 'net.ipv4.conf.all.log_martians', value: 1 }
cis_v_3_2_4_ipv4_conf_default_log_martians: { proc_src: '/proc/sys/net/ipv4/conf/default/log_martians', kernel_param: 'net.ipv4.conf.default.log_martians', value: 1 }
cis_v_3_2_4_ipv4_route_flush: { proc_src: '/proc/sys/net/ipv4/route/flush', kernel_param: 'flush', value: 1 }

# 3.2.5
cis_v_3_2_5_ipv4_icmp_echo_ignore_broadcasts: { proc_src: '/proc/sys/net/ipv4/icmp_echo_ignore_broadcasts', kernel_param: 'net.ipv4.icmp_echo_ignore_broadcasts', value: 1 }
cis_v_3_2_5_ipv4_route_flush: { proc_src: '/proc/sys/net/ipv4/route/flush', kernel_param: 'flush', value: 1 }

# 3.2.6
cis_v_3_2_6_ipv4_icmp_echo_ignore_bogus_error_responses: { proc_src: '/proc/sys/net/ipv4/icmp_ignore_bogus_error_responses', kernel_param: 'net.ipv4.icmp_ignore_bogus_error_responses', value: 1 }
cis_v_3_2_6_ipv4_route_flush: { proc_src: '/proc/sys/net/ipv4/route/flush', kernel_param: 'flush', value: 1 }

# 3.2.7
cis_v_3_2_7_ipv4_conf_all_rp_filter: { proc_src: '/proc/sys/net/ipv4/conf/all/rp_filter', kernel_param: 'net.ipv4.conf.all.rp_filter', value: 1 }
cis_v_3_2_7_ipv4_conf_default_rp_filter: { proc_src: '/proc/sys/net/ipv4/conf/default/rp_filter', kernel_param: 'net.ipv4.conf.default.rp_filter', value: 1 }
cis_v_3_2_7_ipv4_route_flush: { proc_src: '/proc/sys/net/ipv4/route/flush', kernel_param: 'flush', value: 1 }

# 3.2.8
cis_v_3_2_8_ipv4_tcp_syncookies: { proc_src: '/proc/sys/net/ipv4/tcp_syncookies', kernel_param: 'net.ipv4.tcp_syncookies', value: 1 }
cis_v_3_2_8_ipv4_route_flush: { proc_src: '/proc/sys/net/ipv4/route/flush', kernel_param: 'flush', value: 1 }

# 3.3.1
cis_v_3_3_1_ipv6_conf_all_accept_ra: { proc_src: '/proc/sys/net/ipv6/conf/all/accept_ra', kernel_param: 'net.ipv6.conf.all.accept_ra', value: 0 }
cis_v_3_3_1_ipv6_conf_default_accept_ra: { proc_src: '/proc/sys/net/ipv6/conf/default/accept_ra', kernel_param: 'net.ipv6.conf.default.accept_ra', value: 0 }
cis_v_3_3_1_ipv4_route_flush: { proc_src: '/proc/sys/net/ipv4/route/flush', kernel_param: 'flush', value: 1 }

# 3.3.2
cis_v_3_3_2_ipv6_conf_all_accept_redirects: { proc_src: '/proc/sys/net/ipv6/conf/all/accept_redirects', kernel_param: 'net.ipv6.conf.all.accept_redirects', value: 0 }
cis_v_3_3_2_ipv6_conf_default_accept_redirects: { proc_src: '/proc/sys/net/ipv6/conf/default/accept_redirects', kernel_param: 'net.ipv6.conf.default.accept_redirects', value: 0 }
cis_v_3_3_2_ipv4_route_flush: { proc_src: '/proc/sys/net/ipv4/route/flush', kernel_param: 'flush', value: 1 }

# 3.4.2
## Examples - but I cannot get them to work :-(
cis_hosts_allow_all_ips:
  - "127.0.0.1"
  - "*.compute.amazonaws.com"

# 3.6.1
# Installation of Firewalld Service
cis_firewalld_install: { package: firewalld, state: present, service: firewalld, rstate: started, enabled: true, exception: 123 }

# 4.1
## Configuration for the auditd.conf
# 4.1.1.1
# Max log file in MB
cis_max_log_file: 8

# 4.1.1.2
## Ensure System is disabled when audit logs are full
cis_space_left_action: email # Default SYSLOG
cis_action_mail_acct: root # Default root
cis_admin_space_left_action: halt # Default SUSPEND

# 4.1.1.3
## Ensure Audit logs are not automatically deleted
cis_max_log_file_action: keep_logs # Default ROTATE

# 4.1 - Remaining Auditd Logs
cis_local_events: "yes"
cis_write_logs: "yes"
cis_log_file: /var/log/audit/audit.log
cis_log_group: root
cis_log_format: RAW
cis_flush: INCREMENTAL_ASYNC
cis_freq: 50
cis_num_logs: 5
cis_priority_boost: 4
cis_disp_qos: lossy
cis_dispatcher: /sbin/audispd
cis_name_format: NONE
##cis_name: mydomain
cis_space_left: 75
cis_admin_space_left: 50
cis_disk_full_action: SUSPEND
cis_disk_error_action: SUSPEND
cis_use_libwrap: "yes"
##cis_tcp_listen_port:
cis_tcp_listen_queue: 5
cis_tcp_max_per_addr: 1
##cis_tcp_client_ports: 1024-65535
cis_tcp_client_max_idle: 0
cis_enable_krb5: "no"
cis_krb5_principal: auditd
##cis_krb5_key_file: /etc/audit/audit.key
cis_distribute_network: "no"
## The following are commented out in the Audit File but are required for the variables
cis_name: mydomain
cis_tcp_listen_port: blank
cis_tcp_client_ports: 1024-65535
cis_krb5_key_file: /etc/audit/audit.key

# 4.2.3
# You should only enable either rsyslog or syslog-ng, but not both.
cis_enable_rsyslog: true # Set to true if rsyslog should be enabled/configured.
cis_enable_syslog_ng: false # Set to true if syslog_ng should be enabled/configured.

# 4.2.1.4
cis_rsyslog_remote_loghost_address: "loghost.example.com" # Can be a hostname or IP address. If no forwarding should occur, exclude this check.

# 4.2.1.5
cis_rsyslog_accept_remote_messages: false # Set to true if the host should accept remote syslog messages.

# 4.2.2.3
cis_syslog_ng_file_perms: "0640"

# 4.3
cis_logrotate_period: weekly
cis_logrotate_keep: "rotate 4"
cis_logrotate_create: create
cis_logrotate_suffix: dateext

# 5.2.5
cis_sshd_max_auth_tries: 4

# 5.2.11
cis_sshd_ciphers: "aes256-ctr,aes192-ctr,aes128-ctr"

# 5.2.12
cis_sshd_macs: "hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-512,hmac-sha2-256,umac-128@openssh.com"

# 5.2.13
cis_sshd_client_alive_interval: 300
cis_sshd_client_alive_count_max: 0

# 5.2.14
cis_sshd_login_grace_time: 60

# 5.2.15
cis_sshd_allow_users: "ec2-user" # A comma-delimited list of users to allow ssh access to
cis_sshd_allow_groups: "ec2-user" # A comma-delimited list of groups ot allow ssh access to
cis_sshd_deny_users: "" # A comma-delimited list of users to deny ssh access for
cis_sshd_deny_groups: "" # A comma-delimited list of groups to deny ssh access for

# 5.2.16
cis_sshd_banner: "/etc/issue.net"

# 5.3.1
cis_pwquality_minlen: "14" # Minimum number of characters required for passwords
cis_pwquality_dcredit: "-1" # At least one digit must be provided
cis_pwquality_ucredit: "-1" # At least one uppercase character must be provided
cis_pwquality_ocredit: "-1" # At least one special character must be provided
cis_pwquality_lcredit: "-1" # At least one lowercase character must be provided

# 5.3.2
cis_pwfailed_attempts: "5" # Number of failed login attempts before account locked
cis_pwunlock_time: "900" # Time in seconds before the login attempt can be tried again without auto failing

# 5.3.3
cis_pwretry_number: "3" # Number of times a password can be attempted before sending back a failure
cis_pwreuse_number: "5" # Ensure password reuse is limited to this number

# 5.3.4
cis_passwd_hash: "sha512" # Options are sha512 or md5

# 5.4.1
cis_pass_max_days: 90
cis_pass_min_days: 7
cis_pass_warn_age: 7
cis_pass_inactive_lock: 30

# 5.4.2
cis_skip_lock_users:
  - root
  - halt
  - shutdown
  - sync

# 5.4.4
cis_umask_default: "027"
cis_umask_shell_files:
  - /etc/bashrc
  - /etc/profile

# 5.5
cis_wheel_group_members: "root"
